<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Listing</title>
</head>
<body>
    <h1>Edit Listing</h1>
    <form action="/listings/<%= listing._id %>?_method=PUT" method="POST" enctype="multipart/form-data">
        <div>
            <label for="title">Title:</label>
            <input type="text" id="title" name="title" value="<%= listing.title %>" required>
        </div>
        <br>
        <div>
            <label for="description">Description:</label>
            <textarea id="description" name="description" required><%= listing.description %></textarea>
        </div>
        <br>
        <div>
            <label for="price">Price:</label>
            <input type="number" id="price" name="price" value="<%= listing.price %>" min="0" step="0.01" required>
        </div>
        <br>
        <div>
            <label for="address">Address:</label>
            <input type="text" id="address" name="address" value="<%= listing.address %>" required>
        </div>
        <br>
        <div>
            <label for="zip">ZIP Code:</label>
            <input type="text" id="zip" name="zip" value="<%= listing.zip %>" required>
        </div>
        <br>
        <div>
            <label for="borough">Borough:</label>
            <select id="borough" name="borough" required>
                <option value="Manhattan" <%= listing.borough === 'Manhattan' ? 'selected' : '' %>>Manhattan</option>
                <option value="Brooklyn" <%= listing.borough === 'Brooklyn' ? 'selected' : '' %>>Brooklyn</option>
                <option value="Queens" <%= listing.borough === 'Queens' ? 'selected' : '' %>>Queens</option>
                <option value="Bronx" <%= listing.borough === 'Bronx' ? 'selected' : '' %>>Bronx</option>
                <option value="Staten Island" <%= listing.borough === 'Staten Island' ? 'selected' : '' %>>Staten Island</option>
            </select>
        </div>
        <br>
        <div>
            <label for="neighborhood">Neighborhood:</label>
            <input type="text" id="neighborhood" name="neighborhood" value="<%= listing.neighborhood %>">
        </div>
        <br>
        <div>
            <label for="bedrooms">Bedrooms:</label>
            <select id="bedrooms" name="bedrooms" required>
                <option value="Studio" <%= listing.bedrooms === 'Studio' ? 'selected' : '' %>>Studio</option>
                <option value="1 bed" <%= listing.bedrooms === '1 bed' ? 'selected' : '' %>>1 bed</option>
                <option value="2 bed" <%= listing.bedrooms === '2 bed' ? 'selected' : '' %>>2 bed</option>
                <option value="3 bed" <%= listing.bedrooms === '3 bed' ? 'selected' : '' %>>3 bed</option>
                <option value="4 bed" <%= listing.bedrooms === '4 bed' ? 'selected' : '' %>>4 bed</option>
            </select>
        </div>
        
        <div>
            <label for="shared">Shared:</label>
            <input type="checkbox" id="shared" name="shared" <%= listing.shared ? 'checked' : '' %>>
        </div>
        
        <div>
            <label for="furnished">Furnished:</label>
            <input type="checkbox" id="furnished" name="furnished" <%= listing.furnished ? 'checked' : '' %>>
        </div>
        
        <div>
            <label for="petsAllowed">Pets Allowed:</label>
            <input type="checkbox" id="petsAllowed" name="petsAllowed" <%= listing.petsAllowed ? 'checked' : '' %>>
        </div>
        
        <div>
            <h3>Current Photos</h3>
            <% if (listing.photos && listing.photos.length > 0) { %>
                <% listing.photos.forEach(function(photo, index) { %>
                    <div style="margin-bottom: 10px;">
                        <img src="<%= photo %>" alt="Photo <%= index + 1 %>" style="max-width: 200px; display: block;">
                        <label>
                            <input type="checkbox" name="deletePhotos" value="<%= photo %>"> Delete this photo
                        </label>
                    </div>
                <% }); %>
            <% } else { %>
                <p>No photos available for this listing.</p>
            <% } %>
        </div>
        <br>
        <div>
            <label for="photos">Add Photos:</label>
            <input type="file" id="photos" name="photos" multiple>
        </div>
        <br>
        <button type="submit">Update Listing</button>
    </form>
    <br>
    <a href="/">Back to Home</a>
</body>
</html>